<div class="w-100 d-flex justify-content-center align-items-center m-0 p-0 row d-flex justify-content-center">

  <form class=" flex-column" (input)="onChangeMarkdownEditor()"
        [formGroup]="reviewForm" (ngSubmit)="onSubmit()">

    <div class="col d-flex justify-content-between mb-5">
      <h1>Create review</h1>
      <input [disabled]="!reviewForm.valid" class="d-flex btn btn-primary" value="Create" type="submit">
    </div>


    <div class="row d-flex justify-content-center mt-3">
      <div class="col-lg-4 h-100 row mb-3 d-flex justify-content-center">
        <div class="row w-100">
          <h6>Add image</h6>
          <ngx-dropzone accept="image/png, image/jpeg" class="w-100 d-flex justify-content-center" (change)="onSelectImage($event)">
            <ngx-dropzone-preview class="w-100" [removable]="true" (removed)="onRemoveImage(file)">
              <ngx-dropzone-label *ngIf="file != undefined" class="w-100">
                {{ file!.name! }} {{ file!.type! }}
              </ngx-dropzone-label>
              <ngx-dropzone-label *ngIf="file == undefined" class="w-100">Add image</ngx-dropzone-label>
            </ngx-dropzone-preview>
          </ngx-dropzone>
        </div>
        <div class="row">
          <ngb-rating formControlName="rate" (rateChange)="onRateChange($event)"
                      style="font-size: 25px" [max]="10" [(rate)]="rate" [readonly]="false"></ngb-rating>
        </div>
      </div>


      <div class="col-lg-8 w-100">
        <div class="col mb-2">
          <h6>Review title</h6>
          <input maxlength="100" formControlName="title" class="form-control" type="text">
          <div class="text-danger" *ngIf="reviewForm.controls.title.errors?.required &&
            reviewForm.controls['title'].touched">
            Title is required
          </div>

          <div class="text-danger" *ngIf="reviewForm.controls.title.hasError('minlength')&&
            reviewForm.controls['title'].touched">
            Min length - 5
          </div>
        </div>

        <div class="col mb-2">
          <h6>Product name</h6>
          <input maxlength="100" formControlName="productName" class="form-control" type="text">
          <div class="text-danger" *ngIf="reviewForm.controls.productName.errors?.required &&
            reviewForm.controls['productName'].touched">
            Product name is required
          </div>

          <div class="text-danger" *ngIf="reviewForm.controls.productName.hasError('minlength')&&
            reviewForm.controls['title'].touched">
            Min length - 5
          </div>
        </div>

        <div class="col mb-2">
          <h6>Category</h6>
          <select required formControlName="category"  class="form-select">
            <option *ngFor="let category of categories" value="{{category}}">
              {{category}}
            </option>

          </select>
          <div class="text-danger" *ngIf="reviewForm.controls.category.errors?.required &&
            reviewForm.controls['category'].touched">
            Category is required
          </div>
        </div>

        <div class="col mb-3">
          <h6>Tags</h6>
          <div id="tag-block">
            <div class="form-group">

              <tag-input (onRemove)="onTagRemove($event)" (onAdd)="onTagAdd($event)"
                         [ngModel]="tags" [ngModelOptions]="{standalone: true}"
                         class=".tag-input" theme="dark" [onlyFromAutocomplete]="false">
                <tag-input-dropdown
                  [autocompleteObservable]="requestAutocompleteTags" displayBy="name"
                  identifyBy="name">
                </tag-input-dropdown>
              </tag-input>

            </div>

            <div class="text-danger" *ngIf="reviewForm.controls.tags.errors?.required">
              Tags are required
            </div>
          </div>
        </div>


      </div>
    </div>


    <div class="row w-100 d-flex justify-content-center p-0 m-0">
      <div class="col-lg-6 h-100 row mb-2 d-flex justify-content-center">
        <h6>Description</h6>
        <div class="text-danger" *ngIf="reviewForm.controls.description!.value!.length > 20000">
          Max length - 20 000
        </div>
        <markdown-editor [control]="descriptionRawControl"></markdown-editor>
      </div>

      <div class="col-lg-6 h-100 row d-flex justify-content-center">
        <h6>Markdown preview</h6>
        <div class="markdown-div">
          <markdown [data]='value'></markdown>
        </div>
      </div>
    </div>
  </form>

</div>



